ในหัวข้อนี้ คุณจะเห็นวิธีการเรียกใช้โฟลว์ที่กำหนดไว้ล่วงหน้าโดยใช้ทริกเกอร์ที่เรียกว่า**Recurrence**  คุณจะสร้างโฟลว์สำหรับทีมการตลาด Contoso ซึ่งดึงอีเมลแอดเดรสของลูกค้าจากตาราง Excel ใน OneDrive โดยอัตโนมัติ คุณจะกำหนดค่าโฟลว์เพื่อให้ที่อยู่อีเมลที่ใหม่ที่ถูกเพิ่มไปยังสเปรดชีตจะแล้วถูกเพิ่มลงในรายการลูกค้า MailChimp หนึ่งครั้งต่อวัน 

## <a name="create-a-scheduled-flow"></a>สร้างโฟลว์ตามกำหนดเวลา
1. เปิด**Microsoft Flow**เลือก**โฟลว์ของฉัน**แล้ว เลือก**สร้างจากเอกสารเปล่า** 
   
    ![](./media/learning-recurrence/flow-create-blank.png)
2. เลือก**ค้นหาตัวเชื่อมต่อและทริกเกอร์หลายร้อยตัว**
3. ค้นหา**กำหนดเวลา** แล้วเลือกทริกเกอร์ **กำหนดเวลา- การเกิดขึ้นประจำ**
   
    ![](./media/learning-recurrence/flow-recurrence-trigger.png)
4. ตั้งค่า**ความถี่**เมื่อต้องการ**วัน**และ**ช่วง**เป็น**1** เลือก**ขั้นตอนใหม่**และเลือก**เพิ่มแอคชัน** 
   
    ![](./media/learning-recurrence/frequency-interval.png)
5. ค้นหา**Excel**เลือกเซอร์วิซ**Excel**และเลือกการกระทำ**Excel – รับแถว** 
   
    ![](./media/learning-recurrence/excel-get-rows.png)
   
    **หมายเหตุ**: ให้แน่ใจว่าได้เลือก**รับแถวต่างๆ**ไม่ใช่**รับแถว** 
6. เลือก**ชื่อไฟล์**และนำทางไปยังตำแหน่งที่ตั้งไฟล์ของคุณ เลือก**ชื่อตาราง**และเลือกตารางที่ต้องการในกระดาษคำนวณ 
   
    ![](./media/learning-recurrence/excel-get-file.png)
7. เพิ่มการดำเนินการใหม่ 
   
    ![](./media/learning-recurrence/new-step.png)
8. ค้นหาเซอร์วิซ**MailChimp** จากนั้นเลือกการกระทำ**MailChimp - เพิ่มสมาชิกไปยังรายการ**
   
    ![](./media/learning-recurrence/select-mailchimp.png)
   
    **หมายเหตุ:** MailChimp คือตัวเชื่อมต่อแบบ*premium* ขึ้นอยู่กับสิทธิ์ของคุณ Microsoft Flow คุณอาจจำเป็นต้องลงทะเบียนสำหรับการทดลองใช้เมื่อต้องใช้ตัวเชื่อมต่อนี้
9. เพิ่มคำ**รายการ Id** และเขตข้อมูล**สถานะ**จากเมนูดรอปดาวน์:
   
   * **รายการ Id** – เลือกรายการอีเมล MailChimp ที่คุณต้องการ
   * **สถานะ** – เลือก**สมัครใช้งาน** 
     
     ![](./media/learning-recurrence/mailchimp-id-status.png)
10. ใน**ที่อยู่อีเม** ใช้คุณลักษณะเนื้อหาแบบไดนามิกเพื่อเพิ่มเขตข้อมูล**ContactEmail** 
    
     ![](./media/learning-recurrence/mailchimp-address.png)
    
     โปรดสังเกตว่า โฟลว์สร้างขั้นตอนการเพิ่มเติมโดยอัตโนมัติ โฟลว์ตรวจพบว่า คุณกำลังจะตั้งค่าการดำเนินการที่จำเป็นต้องมีการกระทำเพิ่มเติม เมื่อใดก็ตามที่โฟลว์อ่านที่อยู่อีเมลใหม่ ระบบจะสร้างการดำเนินการใหม่สำหรับแต่ละแถว 
    
     ![](./media/learning-recurrence/mailchimp-for-each.png)
11. ใช้เนื้อหาแบบไดนามิกเพื่อกรอกข้อมูลในเขตข้อมูล**ชื่อ**และ**นามสกุล**:
    
    * **ชื่อ**– FirstName
    * **นามสกุล**– นามสกุล
      
      ![](./media/learning-recurrence/mailchimp-names.png)

ตอนนี้โฟลว์นี้จะเรียกใช้วันละครั้ง และรับแถวใหม่จากตาราง Excel นี้ หยิบอยู่อีเมลและชื่อ และใช้พวกมันเพื่อใส่ข้อมูลรายการอีเมล์ MailChimp Contoso ซึ่งประหยัดทั้งเวลาและเงิน 

